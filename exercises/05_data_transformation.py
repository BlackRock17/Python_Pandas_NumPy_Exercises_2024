import pandas as pd

# Зареждане на данните
df = pd.read_csv('../data/employees.csv')

print("Оригинален DataFrame:")
print(df)

# Добавяне на нова колона
df['бонус'] = df['заплата'] * 0.1
print("\nDataFrame с добавена колона 'бонус':")
print(df)

# Прилагане на функция върху колона
def категория_възраст(age):
    if age < 30:
        return 'Млад'
    elif age < 40:
        return 'Средна възраст'
    else:
        return 'Старши'

df['възрастова_категория'] = df['възраст'].apply(категория_възраст)
print("\nDataFrame с добавена колона 'възрастова_категория':")
print(df)

# Промяна на стойности в колона
df['град'] = df['град'].replace('София', 'Sofia')
print("\nDataFrame с променени имена на градове:")
print(df)

# Изчисляване на нова колона базирана на множество други колони
df['общ_доход'] = df['заплата'] + df['бонус']
print("\nDataFrame с добавена колона 'общ_доход':")
print(df)

# Прилагане на операция върху цял DataFrame
df_normalized = (df[['заплата', 'възраст', 'бонус']] - df[['заплата', 'възраст', 'бонус']].mean()) / df[['заплата', 'възраст', 'бонус']].std()
print("\nНормализиран DataFrame за числовите колони:")
print(df_normalized)