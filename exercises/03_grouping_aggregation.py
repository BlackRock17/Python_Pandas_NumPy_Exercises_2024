import pandas as pd

# Четене на данни от CSV файл
df = pd.read_csv('../data/employees.csv')

# Групиране по град и изчисляване на средната заплата
print("Средна заплата по градове:")
avg_salary_by_city = df.groupby('град')['заплата'].mean()
print(avg_salary_by_city)

# Групиране по град и намиране на максималната възраст
print("\nМаксимална възраст по градове:")
max_age_by_city = df.groupby('град')['възраст'].max()
print(max_age_by_city)

# Групиране по град и изчисляване на няколко агрегации
print("\nРазлични агрегации по градове:")
city_stats = df.groupby('град').agg({
    'заплата': ['mean', 'min', 'max'],
    'възраст': ['mean', 'min', 'max']
})
print(city_stats)

# Преименуване на колоните за по-добра четимост
city_stats.columns = ['Средна заплата', 'Минимална заплата', 'Максимална заплата',
                      'Средна възраст', 'Минимална възраст', 'Максимална възраст']
print("\nАгрегации с преименувани колони:")
print(city_stats)